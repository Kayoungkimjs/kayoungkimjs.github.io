{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/Google-Sheets-API-연동-다국어(i18n)-자동화하기","result":{"data":{"markdownRemark":{"id":"1d6a3641-464f-5081-9fc9-d8a4d3b39711","html":"<h2 id=\"google-sheets-api-연동을-위한-선행-작업\" style=\"position:relative;\"><a href=\"#google-sheets-api-%EC%97%B0%EB%8F%99%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%84%A0%ED%96%89-%EC%9E%91%EC%97%85\" aria-label=\"google sheets api 연동을 위한 선행 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Sheets API 연동을 위한 선행 작업</h2>\n<ol>\n<li>다국어 텍스트 시트 준비한다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cfc2e8c7702461e50cdc72d77eeb0dd6/12bff/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTUlEQVQ4y82TW07DMBBFu/9t8M9GWEU/CqVO4nf8TC6aSRy5FYjyR6Qre8bO8fhxT2d9weXzHVopGGPgnIP3M6y1mOcZ3nvOpZSwriuWZWHVpaLkivMk8PL2ilQy6Dv5ECC1xSQ1nA+IMTKQIDlnjqlvrEUuBTElpJS5X0pFzBl6trwIAz+uAy43DaEC3geL601sk2uFEAOs85BK88/aGNY4TXDOM7iJxhkolYKUEjknlFJwEwJaa97iOI6HaOvDMBxqR1Jr3bVXOIdwJI/z2WM6s5bvx9tZ9rllWTeg875LPqf6GO/gDej804D60/hfgc8uyED7H4FLDzTW3a103Gp32483/d2cuwrpGfS26rWu90+lbx9zW4XGQmmDSSpoa6CcYRdY5xBCRIwJIfZt0xaTARQbYfcylUsOId+S3cj09OrbVsovojkEaxV+AYAYSkjZctCOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cfc2e8c7702461e50cdc72d77eeb0dd6/8ac56/image1.webp 240w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/d3be9/image1.webp 480w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/e46b2/image1.webp 960w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/6ed01/image1.webp 1032w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cfc2e8c7702461e50cdc72d77eeb0dd6/8ff5a/image1.png 240w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/e85cb/image1.png 480w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/d9199/image1.png 960w,\n/static/cfc2e8c7702461e50cdc72d77eeb0dd6/12bff/image1.png 1032w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cfc2e8c7702461e50cdc72d77eeb0dd6/d9199/image1.png\"\n            alt=\"image1.png\"\n            title=\"image1.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>Google Cloud Platform에 접속해서 새 프로젝트를 생성\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/307161f8c05ddab54ce577380f277542/2cefc/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABcUlEQVQoz42Sz0/UQBSA+3cSs1xJjHj1T1HgIAFO3g2SoJhwBQIIqAcjttvd0JbZbjvtdH59ZroLCdHdMMmXmczM+968l4k2jioGW/es7wnW3ue83Cl48S7rebVb8Hpvxtp2wWAjZ7D5L6ubOStvM958EESnv2p2Dn/z8aTgy03L4ZXk06Xk4Jvk6Kbha+B7w+ewf1H9l4OLiv3ziuMfkggc6AqrpriuBiNn6Bqva9CyP8MrnjMirTWlyLn+GXN29Yc4GTEcpsRJSjJMSUdj4jghzwucB+v8QpzzRNZa7rKc21Qwzltqqei67hGlFG2rkLLBe9+/IsyLiIwxJEnCeJSiVDMXtDRNQ6sUnTb0VZSTJ8KFJTvnuBcCIURfVlmWTCYTsiyjnFa0ymCMxRgXVATXUqG1hnSY9KIwQoJACJqtLbLVVLJ7nvB2rNjev2NahR65x148SGfBfi57EC0RdtpRlBrr3MKLvW5+1CdZ8m3+AtQ68+t91vZEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/307161f8c05ddab54ce577380f277542/8ac56/image2.webp 240w,\n/static/307161f8c05ddab54ce577380f277542/d3be9/image2.webp 480w,\n/static/307161f8c05ddab54ce577380f277542/e46b2/image2.webp 960w,\n/static/307161f8c05ddab54ce577380f277542/7f403/image2.webp 1400w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/307161f8c05ddab54ce577380f277542/8ff5a/image2.png 240w,\n/static/307161f8c05ddab54ce577380f277542/e85cb/image2.png 480w,\n/static/307161f8c05ddab54ce577380f277542/d9199/image2.png 960w,\n/static/307161f8c05ddab54ce577380f277542/2cefc/image2.png 1400w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/307161f8c05ddab54ce577380f277542/d9199/image2.png\"\n            alt=\"image2.png\"\n            title=\"image2.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>API 및 서비스 -> API 및 서비스 사용 설정 -> Google Sheets를 검색 -> 해당 API를 사용으로 변경\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/efbdf352259d4a083806b44a78d7bbf4/a3767/image3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz5VS20oDMRTM5/mkVEFEQb/Ih7aKtw8SffJJq2IpC9q9pN1tu2azm8vISRvZ3baCB4aTMyeZTC7s7DbGQT/E4WWE4+sEBxcJOr1lvd9PsHO+5E9uEpzecRxdJdjtxtjr1dCN0enHeApKsPeA42UY4nUUYzyVCKcSb6MIH0GEIBJ4HMzxMJjj/nmG4VggyiQ+JxJfK4zT0iFMS5TKgOWFAZ8pTBcGC2GhDf4VupKopICqChitwQopkXCObyFgLWAsIKWEEMItsNY2YAjGQimFopDQ2qBSCkppxzOtNSYTjizLfgWIIyzrpiNjjOv53A5G6pzzNUd+wSaQOy9OY8/TOkZEnudrgnTsOoqiQFmWDWdUE+/nUI+1Ldcdtu+P4B1t6jmH9aIu6I9RVZUToezHtBnBc553gm1nFDQhTVN3FZte+k+HdUGfaXe6H79r49us3G2LjYK29le2Odnm8Adz/Zp3fRY/awAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/efbdf352259d4a083806b44a78d7bbf4/8ac56/image3.webp 240w,\n/static/efbdf352259d4a083806b44a78d7bbf4/d3be9/image3.webp 480w,\n/static/efbdf352259d4a083806b44a78d7bbf4/e46b2/image3.webp 960w,\n/static/efbdf352259d4a083806b44a78d7bbf4/efe91/image3.webp 1210w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/efbdf352259d4a083806b44a78d7bbf4/8ff5a/image3.png 240w,\n/static/efbdf352259d4a083806b44a78d7bbf4/e85cb/image3.png 480w,\n/static/efbdf352259d4a083806b44a78d7bbf4/d9199/image3.png 960w,\n/static/efbdf352259d4a083806b44a78d7bbf4/a3767/image3.png 1210w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/efbdf352259d4a083806b44a78d7bbf4/d9199/image3.png\"\n            alt=\"image3.png\"\n            title=\"image3.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>서비스 계정 생성\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26bbfd499c86f85ff01194e0b10ce982/252a4/image4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABU0lEQVQoz22QaU7DMBCFe1+EQKj8gdOwFQnOBFJbWtrETrwkXuM8NA7ugrD0NJ4lX954dv9W4eqpxu0rx80Lx+VDlXXxyDBf8FyfLxgun070eNT18xTv3jm0TZitdi0+1hW2rANTEZ+bBstvgQ13WFYO2yZiy3rsRTioVsNB7DdyPSCNI2bOOWjdIYYAYIRRDVi9Q8P2qHYbdKqFdwbOdLBGYxwCUvT/aiRgIy2+9hKdTbA+QUoJax1aIbBarcE5h5Qq513f556xFs57OFfkcp6BzlpI0WJMA+gopWGMyUMEq+saSqlcs9bCe5/jMAyIMZ7FDAwhIMYpSWlySCCC0KD3kwOaoztF+phE8zRDNbpnIDXKoYIQIgO11nmYYOSuQAhKoh6Jen3fHx3+BZb16I/FRREBTvPiqmx3BqRkekOFtm1hnZ3WiSGruDl1VzQ9W8zAH21mrAggu86TAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26bbfd499c86f85ff01194e0b10ce982/8ac56/image4.webp 240w,\n/static/26bbfd499c86f85ff01194e0b10ce982/d3be9/image4.webp 480w,\n/static/26bbfd499c86f85ff01194e0b10ce982/e46b2/image4.webp 960w,\n/static/26bbfd499c86f85ff01194e0b10ce982/bf23a/image4.webp 1314w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26bbfd499c86f85ff01194e0b10ce982/8ff5a/image4.png 240w,\n/static/26bbfd499c86f85ff01194e0b10ce982/e85cb/image4.png 480w,\n/static/26bbfd499c86f85ff01194e0b10ce982/d9199/image4.png 960w,\n/static/26bbfd499c86f85ff01194e0b10ce982/252a4/image4.png 1314w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26bbfd499c86f85ff01194e0b10ce982/d9199/image4.png\"\n            alt=\"image4.png\"\n            title=\"image4.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>키를 만들면 JSON키 파일을 다운로드 할 수 있음\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/91f94c46316bd3c243d7ccfc2709e2ec/d5b59/image5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4klEQVQoz4WS+2oTQRSH9yUFUVurvkORGqsPURETkya7O5e95SJFsps0adMGk5D4Avm7FEqFIJI2heSTmZJIQfHAx5y5MOf3OzPO490yz3M+O/uKZ28kT15XeLoneLGvefVe8/KdtntbOcX22z9s5aRlOyfZ2dc82i1TOfqG47llolATBhqtJNJ3ba6EjxIegZZEgSIK5ANqSUi9FlOvxjRqCaGWfJ+McVzXI4pipJQoKdFao4OING2RZRlpmtJMUzumZp5lZFmLIIzwfR8hJVIqDstlBoMBTrFYJAxDlFYI3+PDwQH1eoPZbMbFxQWXl5dcXV1xff2D5XLJ3d0dJprNJoVCAdd1LSbv9/s4FU+hgwQhFK6n+fjpM40vR8zn8w23t7fc3NxsMJd2ux2CIKBarVqMs8lkglMsuXi+RAiJkCGup/jabDH7+QtY8a84Pj62bYrj2CKEYDwe4wSBplpNiKIIpSSHhyWyLLUq1uoWiwWr1WqDiXa7bXtoVBo8z2M0GuGYxPQwSRLiOLGVOp0O/4tut2ttri0rpe4t5/N5SqWSrWYWDcbKfYH4AWbNOFn/CvszlLIXVyoVhsMhzunpKefn55ydndnR0Ov1rMq/YZSZBzFn1ufN656cnDCdTvkNhgZ6UK51rBkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/91f94c46316bd3c243d7ccfc2709e2ec/8ac56/image5.webp 240w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/d3be9/image5.webp 480w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/e46b2/image5.webp 960w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/13018/image5.webp 1370w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/91f94c46316bd3c243d7ccfc2709e2ec/8ff5a/image5.png 240w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/e85cb/image5.png 480w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/d9199/image5.png 960w,\n/static/91f94c46316bd3c243d7ccfc2709e2ec/d5b59/image5.png 1370w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/91f94c46316bd3c243d7ccfc2709e2ec/d9199/image5.png\"\n            alt=\"image5.png\"\n            title=\"image5.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>마지막으로 다국어 시트를 생성한 서비스 계정에 공유</li>\n</ol>\n<h2 id=\"react-애플리케이션에서-다국어-시트를-json파일로-변환하기\" style=\"position:relative;\"><a href=\"#react-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%97%90%EC%84%9C-%EB%8B%A4%EA%B5%AD%EC%96%B4-%EC%8B%9C%ED%8A%B8%EB%A5%BC-json%ED%8C%8C%EC%9D%BC%EB%A1%9C-%EB%B3%80%ED%99%98%ED%95%98%EA%B8%B0\" aria-label=\"react 애플리케이션에서 다국어 시트를 json파일로 변환하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React 애플리케이션에서 다국어 시트를 JSON파일로 변환하기</h2>\n<p>React에서 프로젝트를 생성하고, Google Sheets API를 연동하기 위해 google-spreadsheet 라이브러리를 설치</p>\n<h3 id=\"sheet를-json으로-변환하는-간단한-모듈-개발하기\" style=\"position:relative;\"><a href=\"#sheet%EB%A5%BC-json%EC%9C%BC%EB%A1%9C-%EB%B3%80%ED%99%98%ED%95%98%EB%8A%94-%EA%B0%84%EB%8B%A8%ED%95%9C-%EB%AA%A8%EB%93%88-%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0\" aria-label=\"sheet를 json으로 변환하는 간단한 모듈 개발하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sheet를 Json으로 변환하는 간단한 모듈 개발하기</h3>\n<p><code class=\"language-text\">.env</code> 파일에 스크립트에서 참조하는 환경변수를 선언한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// .env</span>\n<span class=\"token constant\">DOC_ID</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DOC_ID</span>입력 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">CLIENT_EMAIL</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CLIENT_EMAIL</span>입력 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">PRIVATE_KEY</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">PRIVATE_KEY</span>입력 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>google-spreadsheet 라이브러리를 활용하여 sheet 데이터를 JSON 파일로 변환하는 로직 구현</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//sheet-to-json.js</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fs\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> GoogleSpreadsheet <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"google-spreadsheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dotenv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 시트 초기화 - Sheet URL에 있는 docID 입력</span>\n  <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GoogleSpreadsheet</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DOC_ID</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 인증 초기화</span>\n  <span class=\"token keyword\">await</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">useServiceAccountAuth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">client_email</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">CLIENT_EMAIL</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">private_key</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PRIVATE_KEY</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\\\\\\\n</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">gm</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">await</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">loadInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> sheets <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span>_rawSheets<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 지원하는 언어 - 한국어, 영어, 중국어, 일본어</span>\n  <span class=\"token keyword\">const</span> supportedLang <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"ko-KR\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"en-US\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"zh-CN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ja-JP\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token keyword\">await</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> sheet <span class=\"token keyword\">of</span> sheets<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 숨김 처리된 시트는 스크립트를 실행하지 않음</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>sheet<span class=\"token punctuation\">.</span>_rawProperties<span class=\"token punctuation\">.</span>hidden<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> rows <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      supportedLang<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">lang</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> rows<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> cur</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>acc<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>cur<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> cur<span class=\"token punctuation\">[</span>lang<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// json파일 저장 위치</span>\n        <span class=\"token keyword\">const</span> dir <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">public/assets/locales/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>lang<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">existsSync</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          fs<span class=\"token punctuation\">.</span><span class=\"token function\">mkdirSync</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">recursive</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">// 동기식으로 파일 쓰기(writeFileSync)</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n          fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>dir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>sheet<span class=\"token punctuation\">.</span>title<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.json</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"File written successfully\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"packagejson-파일에-npm-스크립트-추가하기\" style=\"position:relative;\"><a href=\"#packagejson-%ED%8C%8C%EC%9D%BC%EC%97%90-npm-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-label=\"packagejson 파일에 npm 스크립트 추가하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>package.json 파일에 npm 스크립트 추가하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"sheetToJson\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node sheet-to-json.js\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"실행-방법\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95\" aria-label=\"실행 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행 방법</h3>\n<ol>\n<li>\n<p>package.json파일에 npm 스크립트 추가했을 경우\n<code class=\"language-text\">npm run sheetToJson</code></p>\n</li>\n<li>\n<p>node 사용 방법 (npm 스크립트 추가 없이 사용 가능)\n<code class=\"language-text\">cd script/ &lt;- cd \"폴더명\"</code> <code class=\"language-text\">으로 해당 파일 위치 폴더로 이동</code>\n<code class=\"language-text\">node sheet-to-json.js &lt;- node 파일명 실행</code></p>\n</li>\n</ol>\n<p>참고</p>\n<ul>\n<li><a href=\"https://meetup.toast.com/posts/295\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://meetup.toast.com/posts/295</a></li>\n<li><a href=\"https://code-bross.tistory.com/12\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://code-bross.tistory.com/12</a></li>\n<li><a href=\"https://frhyme.github.io/googlecloudplatform/GCP000_Access_Google_sheet_by_python/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://frhyme.github.io/googlecloudplatform/GCP000_Access_Google_sheet_by_python/</a></li>\n<li><a href=\"https://www.npmjs.com/package/google-spreadsheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.npmjs.com/package/google-spreadsheet</a></li>\n<li><a href=\"https://theoephraim.github.io/node-google-spreadsheet/#/getting-started/authentication\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://theoephraim.github.io/node-google-spreadsheet/#/getting-started/authentication</a></li>\n</ul>","fields":{"slug":"/posts/2023-05-30---Google-Sheets-API-연동-다국어(i18n)-자동화하기//posts/Google-Sheets-API-연동-다국어(i18n)-자동화하기","tagSlugs":["/tag/i18n/","/tag/google-sheets/","/tag//"]},"frontmatter":{"date":"2023-05-30T23:46:37.121Z","description":"구글 시트 텍스트를 json 파일로 변경, 자동으로 프로젝트에 연동하는 방법을 알아본다.","tags":["i18n","google sheets","다국어"],"title":"Google Sheets API 연동 다국어(i18n) 자동화하기","socialImage":null}}},"pageContext":{"slug":"/posts/2023-05-30---Google-Sheets-API-연동-다국어(i18n)-자동화하기//posts/Google-Sheets-API-연동-다국어(i18n)-자동화하기"}},"staticQueryHashes":["250566491","251939775","401334301"]}