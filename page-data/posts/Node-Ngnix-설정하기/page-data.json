{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/Node-Ngnix-설정하기","result":{"data":{"markdownRemark":{"id":"53351112-df43-59db-8aea-bef49297b301","html":"<h2 id=\"node\" style=\"position:relative;\"><a href=\"#node\" aria-label=\"node permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Node</h2>\n<p>자바스크립트 프로그램을 실행할 수 있는 환경</p>\n<h2 id=\"nodejs\" style=\"position:relative;\"><a href=\"#nodejs\" aria-label=\"nodejs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Node.js</h2>\n<blockquote>\n<p>“node.js는 Chrome v8 javascript 엔진으로 빌드된 javascript 런타임이다.”</p>\n</blockquote>\n<ul>\n<li>기존에는 자바스크립트 프로그램을 웹 브라우저 위에서만 실행할 수 있었는데, 구글이 다른 엔진과 달리 매우 빠르고 오픈소스로 공개한 v8 엔진을 사용하여 크롬을 출시하면서 v8 엔진 기반의 노드 프로젝트가 시작되었음</li>\n<li>노드는 v8(자바스크립트 엔진)과 liubuv(비동기 I/O)라는 라이브러리를 사용하고 C와 C++로 구현</li>\n</ul>\n<blockquote>\n<p>”<strong>Node.js는 자바스크립트 프로그램이 서버로서 기능하기 위한 도구를 제공하고, 자바스크립트 프로그램이 동작하는 환경</strong>” 을 의미한다.</p>\n</blockquote>\n<h2 id=\"서버에-node-설치하기\" style=\"position:relative;\"><a href=\"#%EC%84%9C%EB%B2%84%EC%97%90-node-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"서버에 node 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버에 Node 설치하기</h2>\n<ol>\n<li>서버 접속</li>\n<li>node 버전 관리 : nvm(Node version Manager) 설치</li>\n</ol>\n<ul>\n<li><a href=\"https://github.com/nvm-sh/nvm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nvm</a>은 node js 버전 매니저로 시스템에 여러 개의 nodejs 를 설치하고 사용할 버전을 쉽게 전환할 수록 도와주는 shell script로 <a href=\"https://rvm.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rvm(Ruby Version Manager)</a>와 비슷한 역할을 수행함</li>\n</ul>\n<ol>\n<li>cURL 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"> curl <span class=\"token operator\">-</span>o<span class=\"token operator\">-</span> <span class=\"token operator\">&lt;</span>https<span class=\"token operator\">:</span><span class=\"token comment\">//raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh> | bash</span></code></pre></div>\n<ol start=\"2\">\n<li>Wget 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">wget <span class=\"token operator\">-</span>qO<span class=\"token operator\">-</span> <span class=\"token operator\">&lt;</span>https<span class=\"token operator\">:</span><span class=\"token comment\">//raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh> | bash</span></code></pre></div>\n<ol start=\"3\">\n<li>패키지 관리 : npm 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">rpm</span> <span class=\"token expression\"><span class=\"token operator\">-</span>Uvh <span class=\"token operator\">&lt;</span>http<span class=\"token operator\">:</span></span><span class=\"token comment\">//dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">yum</span> <span class=\"token expression\"><span class=\"token operator\">-</span>y install npm</span></span></code></pre></div>\n<ol start=\"4\">\n<li>node.js 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">nvm</span> <span class=\"token expression\">install nodejs or <span class=\"token punctuation\">[</span>node 버전 입력<span class=\"token punctuation\">]</span></span></span></code></pre></div>\n<h2 id=\"ngnix\" style=\"position:relative;\"><a href=\"#ngnix\" aria-label=\"ngnix permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ngnix</h2>\n<p><strong>웹 서버 소프트웨어</strong>로, 가벼움과 높은 성능을 목표로 한다.</p>\n<h3 id=\"웹-서버\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%EC%84%9C%EB%B2%84\" aria-label=\"웹 서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 서버</h3>\n<ul>\n<li>\n<p>이미지, 동영상, 자바스크립트, HTML 등 다양한 문서를 제공하는 서버 시스템</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/01cb36d9228743e801c2d44463088b96/bd9eb/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABI0lEQVQY022QPUvDUBSGMzr5N1z9GwpuXTqqm4v+BjfBSUcXJxcXV61iq+AodShJE7UkIR8mtbW5SROTGx7JrXQQD7ycwwvnnJdHq4Vg6th4lkkRRzSVBW8Yp7sMjlqEvQvlfRcFQgjSNF1KSsnf0hCCwPPQLYtiMlbmZ/+GXmuFuw0N/WRHeXmWEQYBYRgqRVGErCSyrkiKCaKYUteyOZjiOw66YZCPY5qfcf+Wp4N1HvfWGJ7tUwNpKjBNE8MwlGzbpiprYuHT0S/pWldkpUBjPmeo63S6XfLfhOPnax7aq9xvNQm3FxhSgeM4uK6rehAElGVFIXPcySve17tKq9WzGcJ1GY9GlNHHYtk3GRy3eTncxL87XzJMkkRxbNTM/zH8ATztaV9ecLF7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/01cb36d9228743e801c2d44463088b96/8ac56/image1.webp 240w,\n/static/01cb36d9228743e801c2d44463088b96/d3be9/image1.webp 480w,\n/static/01cb36d9228743e801c2d44463088b96/e46b2/image1.webp 960w,\n/static/01cb36d9228743e801c2d44463088b96/f992d/image1.webp 1440w,\n/static/01cb36d9228743e801c2d44463088b96/daf4e/image1.webp 1442w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/01cb36d9228743e801c2d44463088b96/8ff5a/image1.png 240w,\n/static/01cb36d9228743e801c2d44463088b96/e85cb/image1.png 480w,\n/static/01cb36d9228743e801c2d44463088b96/d9199/image1.png 960w,\n/static/01cb36d9228743e801c2d44463088b96/07a9c/image1.png 1440w,\n/static/01cb36d9228743e801c2d44463088b96/bd9eb/image1.png 1442w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/01cb36d9228743e801c2d44463088b96/d9199/image1.png\"\n            alt=\"image1.png\"\n            title=\"image1.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n<li>\n<p>웹 서버의 역할</p>\n<ol>\n<li>데이터 전송</li>\n</ol>\n<ul>\n<li>HTML 텍스트 파일을 비롯 이미지나 음성 데이터 같은 정적 컨텐츠를 웹 클라이언트에 전송\n⇒ CSR에 의해 생성된 빌드 파일(정적 파일)을 제공할 수 있음</li>\n</ul>\n<ol start=\"2\">\n<li>어플리케이션 실행</li>\n</ol>\n<ul>\n<li>웹 서버 내 PHP와 같은 모듈을 내장해 웹 서버가 직접 Application Server를 실행할 수 있음. 이를 통해 이미지 압축 등 기능을 사용할 수 있음</li>\n</ul>\n<ol start=\"3\">\n<li>프록시 처리</li>\n</ol>\n<ul>\n<li>클라이언트의 요청을 Application Server로 전달하는 역할</li>\n<li>캐시 처리, 로드 밸런싱, 리버스 프록시 서버, 암호화 등을 처리할 수 있으며 웹 서버가 사용되는 가장 큰 이유 중 하나</li>\n<li>리버스 프록시 : 컴퓨터 네트워크에서 클라이언트를 대신해 한 대 이상의 서버로부터 자원을 추출하는 프록시 서버의 일종. 웹 서버 자체에서 기원한 것처럼 해당 클라이언트로 반환.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"ngnix-특징\" style=\"position:relative;\"><a href=\"#ngnix-%ED%8A%B9%EC%A7%95\" aria-label=\"ngnix 특징 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ngnix 특징</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5247129c4f1e96e259258b8bcbdcd15c/0d292/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6ElEQVQY002PDY+CMBBE/f8/8QKVj7ZCCwKtCgXadxHv1Ekmk+xs3mZPewjYnwxXK7pc4KWmy3K8VHSZIG0biZcmfWGs6sNDVTHVkuu5IK7r0aeUOKV9x3Udq3P4vn/n5v2RxPgGzrcb93Fido7Zex7OcZ8mUowf4BICslIY06F1Q98PaHWhbS1aacLf9Zgirr9ia8XQtIzGYpXm2rSsIXyAj3mmLCWZKBCiQDeGsyjJRUFdax7L8gLGyOBvdKOjVBdKqTH9QD96lvD1Ml8y1pCLHGPt9/hYfPqpbduQSlIUZ7z37/4f+Avuc38Onaw/TwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5247129c4f1e96e259258b8bcbdcd15c/8ac56/image2.webp 240w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/d3be9/image2.webp 480w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/e46b2/image2.webp 960w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/f992d/image2.webp 1440w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/7509d/image2.webp 1620w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5247129c4f1e96e259258b8bcbdcd15c/8ff5a/image2.png 240w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/e85cb/image2.png 480w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/d9199/image2.png 960w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/07a9c/image2.png 1440w,\n/static/5247129c4f1e96e259258b8bcbdcd15c/0d292/image2.png 1620w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5247129c4f1e96e259258b8bcbdcd15c/d9199/image2.png\"\n            alt=\"image2.png\"\n            title=\"image2.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>비동기 event driven에 의한 non blocking 처리</li>\n<li>동시 접속수가 늘어날 수록 물리 메모리가 증가하는 프로세스 기반 apache 서버에 비해 소비 메모리량이 적어지면서 동시 처리수를 급격하게 늘릴 수 있음</li>\n<li>single thread 기반으로 마스터 / worker 프로세스 구동 방식을 채택하여 context switcing을 하지 않기 때문에 CPU 사용률을 감소시킬 수 있음</li>\n<li>여러 기능을 모듈 단위로 개발하여 nginx를 컴파일할 때 필요한 모듈들만 조합해서 사용할 수 있음</li>\n</ul>\n<h3 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h3>\n<ul>\n<li>yum 유틸리티 설치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token operator\">~</span># yum install yum<span class=\"token operator\">-</span>utils</code></pre></div>\n<ul>\n<li>ngnix 저장소 추가</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">vi <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>yum<span class=\"token punctuation\">.</span>repos<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span>repo</code></pre></div>\n<ul>\n<li>nginx.repo 파일 설정\n<ul>\n<li>name : 유저 이름baseurl : 데이터를 호출하기 위한 외부 저장소 urlgpgcheck : 프로그램 서명 여부 체크 (활성화 1, 비활성화 0)enabled : yum repo 추가 여부 (1, 0)</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">[</span>nginx<span class=\"token punctuation\">]</span>\nname<span class=\"token operator\">=</span>nginx repo\nbaseurl<span class=\"token operator\">=</span>http<span class=\"token operator\">:</span><span class=\"token comment\">//nginx.org/packages/centos/7/$basearch/</span>\ngpgcheck<span class=\"token operator\">=</span><span class=\"token number\">0</span>\nenabled<span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<ul>\n<li>ngnix 설치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">yum install <span class=\"token operator\">-</span>y nginx</code></pre></div>\n<h3 id=\"config-설정\" style=\"position:relative;\"><a href=\"#config-%EC%84%A4%EC%A0%95\" aria-label=\"config 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>config 설정</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">vi <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span><span class=\"token keyword\">default</span><span class=\"token punctuation\">.</span>conf</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">server <span class=\"token punctuation\">{</span>\n    listen       <span class=\"token number\">53001</span><span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">listen</span>       <span class=\"token expression\"><span class=\"token punctuation\">[</span><span class=\"token operator\">::</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span><span class=\"token number\">8080</span><span class=\"token punctuation\">;</span></span></span>\n\n    <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">server</span><span class=\"token expression\">_name  localhost<span class=\"token punctuation\">;</span> # 도메인 주소 넣는부분</span></span>\n\n    root <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>dist<span class=\"token operator\">/</span><span class=\"token punctuation\">;</span> # 배포할 프로젝트 dist 경로\n    index index<span class=\"token punctuation\">.</span>html index<span class=\"token punctuation\">.</span>htm<span class=\"token punctuation\">;</span>\n\n    client_max_body_size <span class=\"token number\">100</span>M<span class=\"token punctuation\">;</span>\n\n    location <span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n        root <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>dist<span class=\"token punctuation\">;</span>\n        index index<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span>\n        try_files $uri $uri<span class=\"token operator\">/</span> <span class=\"token operator\">/</span>index<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span> #경로 탐색\n    <span class=\"token punctuation\">}</span>\n\n    location <span class=\"token operator\">/</span>graphql <span class=\"token punctuation\">{</span>\n        proxy_pass http<span class=\"token operator\">:</span><span class=\"token comment\">//주소:54001/graphql;</span>\n    <span class=\"token punctuation\">}</span>\n\n    error_page <span class=\"token number\">404</span> <span class=\"token operator\">/</span><span class=\"token number\">404.</span>html<span class=\"token punctuation\">;</span>\n        location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token number\">40</span>x<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n\n    error_page <span class=\"token number\">500</span> <span class=\"token number\">502</span> <span class=\"token number\">503</span> <span class=\"token number\">504</span> <span class=\"token operator\">/</span><span class=\"token number\">50</span>x<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span>\n        location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token number\">50</span>x<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ngnix.conf 설정\n<ul>\n<li>메인 configuration으로 여기에서 default.conf 호출</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">vi <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span>conf</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">worker_processes  <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> ## master process 내부 worker process 수\nevents <span class=\"token punctuation\">{</span> ## 네트워크 동작방법 설정\n    worker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span> ## 하나의 work process는 설정한 수만큼 연결 가능\n<span class=\"token punctuation\">}</span>\nhttp <span class=\"token punctuation\">{</span>\n    include       mime<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">;</span>\n    server <span class=\"token punctuation\">{</span>\n        listen       <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n        location <span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n            root   html<span class=\"token punctuation\">;</span>\n            index  index<span class=\"token punctuation\">.</span>html index<span class=\"token punctuation\">.</span>htm<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>설정 예시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">user  nginx<span class=\"token punctuation\">;</span>         ## NGINX 프로세스가 실행되는 권한<span class=\"token punctuation\">,</span> root 권한은 보안상 위험함\nworker_processes  <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> ## Default<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> CPU 코어 하나에 최소한 한 개의 프로세스가 배정되도록 변경 권장\nworker_priority   <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> ## 값이 작을 수록 높은 우선순위를 갖는다<span class=\"token punctuation\">.</span> 커널 프로세스의 기본 우선순위인 <span class=\"token operator\">-</span><span class=\"token number\">5</span> 이하로는 설정하지 않도록 한다<span class=\"token punctuation\">.</span>\n\n# 로그레벨 <span class=\"token punctuation\">[</span> debug <span class=\"token operator\">|</span> info <span class=\"token operator\">|</span> notice <span class=\"token operator\">|</span> warn <span class=\"token operator\">|</span> error <span class=\"token operator\">|</span> crit <span class=\"token punctuation\">]</span>\nerror_log  <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>error<span class=\"token punctuation\">.</span>log error<span class=\"token punctuation\">;</span> ## 로그레벨을 warn <span class=\"token operator\">-></span> error로 변경함\npid        <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>run<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span>pid<span class=\"token punctuation\">;</span>\n\nevents <span class=\"token punctuation\">{</span>\n    worker_connections  <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span> ## Default<span class=\"token operator\">:</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">,</span> 현 서버는 RAM <span class=\"token number\">8</span>GB라 상향조정\n    multi_accept         off<span class=\"token punctuation\">;</span> ## Default<span class=\"token operator\">:</span> off\n<span class=\"token punctuation\">}</span>\n\nhttp <span class=\"token punctuation\">{</span>\n    include       <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>mime<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">;</span>\n    default_type  application<span class=\"token operator\">/</span>octet<span class=\"token operator\">-</span>stream<span class=\"token punctuation\">;</span>\n\n    log_format  main  '$remote_addr <span class=\"token operator\">-</span> $remote_user <span class=\"token punctuation\">[</span>$time_local<span class=\"token punctuation\">]</span> <span class=\"token string\">\"$request\"</span> '\n                      '$status $body_bytes_sent <span class=\"token string\">\"$http_referer\"</span> '\n                      '<span class=\"token string\">\"$http_user_agent\"</span> <span class=\"token string\">\"$http_x_forwarded_for\"</span>'<span class=\"token punctuation\">;</span>\n\n    access_log  <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>access<span class=\"token punctuation\">.</span>log  main<span class=\"token punctuation\">;</span>\n\n    sendfile        on<span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">tcp</span><span class=\"token expression\">_nopush     on<span class=\"token punctuation\">;</span></span></span>\n\n        server_tokens     off<span class=\"token punctuation\">;</span> ## 헤더에 NGINX 버전을 숨김 <span class=\"token punctuation\">(</span>보안상 설정 권장<span class=\"token punctuation\">)</span>\n    keepalive_timeout  <span class=\"token number\">65</span><span class=\"token punctuation\">;</span> ## 접속 시 커넥션 유지 시간\n\n    <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">gzip</span>  <span class=\"token expression\">on<span class=\"token punctuation\">;</span></span></span>\n\n    include <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token comment\">/*.conf; ## conf 붙은 모든파일을 불러오는부분\n}</span></code></pre></div>\n<ul>\n<li>ngnix 실행</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">systemctl reload nginx\nsystemctl start nginx</code></pre></div>\n<h4 id=\"리버스-프록시\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%B2%84%EC%8A%A4-%ED%94%84%EB%A1%9D%EC%8B%9C\" aria-label=\"리버스 프록시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리버스 프록시</h4>\n<ul>\n<li>reverse proxing은 <code class=\"language-text\">proxy_pass</code>문법을 통해 이용이 가능합니다. ”<code class=\"language-text\">/some/path/</code>로 들어온 url은 모두 <code class=\"language-text\">http://www.example.com/link/</code>로 처리하라” 라는 의미로, 클라이언트의 <strong>요청을 특정 Url로 변환시키는 역할</strong>을 수행</li>\n<li>/etc/nginx/site-available/default의 server 항목 수정</li>\n<li>총 2개의 서버 항목이 존재할 수 있도록</li>\n<li>기본 443 포트 사용, 추가 80번 포트 접속은 https로 리다이렉트</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">server <span class=\"token punctuation\">{</span>\n        listen                  <span class=\"token number\">443</span><span class=\"token punctuation\">;</span>\n        server_name             <span class=\"token punctuation\">{</span>도메인 주소 <span class=\"token number\">1</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>도메인 주소 <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        ssl                     on<span class=\"token punctuation\">;</span>\n        ssl_certificate         <span class=\"token punctuation\">{</span>공개키 경로<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        ssl_certificate_key     <span class=\"token punctuation\">{</span>개인키 경로<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        ssl_protocols           TLSv1 TLSv1<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> TLSv1<span class=\"token punctuation\">.</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n        root <span class=\"token punctuation\">{</span>웹 루트 경로<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        index index<span class=\"token punctuation\">.</span>html index<span class=\"token punctuation\">.</span>htm index<span class=\"token punctuation\">.</span>nginx<span class=\"token operator\">-</span>debian<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span>\n\n        location <span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n                try_files $uri $uri<span class=\"token operator\">/</span> <span class=\"token operator\">=</span><span class=\"token number\">404</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\nserver <span class=\"token punctuation\">{</span>\n    listen <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n    server_name <span class=\"token punctuation\">{</span>도메인 주소 <span class=\"token number\">1</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>도메인 주소 <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">301</span> https<span class=\"token operator\">:</span><span class=\"token comment\">//{도메인 주소};</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"nginx-환경파일-공식문서\" style=\"position:relative;\"><a href=\"#nginx-%ED%99%98%EA%B2%BD%ED%8C%8C%EC%9D%BC-%EA%B3%B5%EC%8B%9D%EB%AC%B8%EC%84%9C\" aria-label=\"nginx 환경파일 공식문서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nginx 환경파일 공식문서</h2>\n<p><strong><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/full/#\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Full Example Configuration</a></strong></p>\n<ul>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/full/#nginx-conf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nginx.conf</a> : 어플리케이션 기본 환경 설정</p>\n</li>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/full/#proxy-conf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">proxy.conf</a> : 프록시 관련 환경 설정</p>\n</li>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/full/#fastcgi-conf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fastcgi.conf</a> : FastCGI 관련 환경 설정</p>\n</li>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/full/#mime-types\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mime.types</a> : 파일 확장명과 MIME 타입 목록</p>\n</li>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/fullexample2/#nginx-conf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nginx.conf</a></p>\n</li>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/fullexample2/#\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Another Full Example</a></p>\n</li>\n<li>\n<p>sites.conf : Ngnix에 의해 서비스되는 가상 호스트 웹사이트 환경 설정. 도메인마다 파일을 분리해서 만들 것을 권장</p>\n</li>\n<li>\n<p>상태 확인</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">systemctl status nginx</code></pre></div>\n<ul>\n<li>서버 재시작 및 리로드</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// Restart ## 서버 중단 후 재가동</span>\nsudo service nginx restart\n\n<span class=\"token comment\">// Reload ## 서버 중단 없이 reload 시점 설정 파일만 다시 불러와 적용</span>\nnginx <span class=\"token operator\">-</span>s reload\n\nreload <span class=\"token comment\">// 설정 파일을 다시 불러오기</span>\nquit <span class=\"token comment\">// 서버 shutdown</span>\nstop <span class=\"token comment\">// 서버 즉시 중단</span>\nreopen <span class=\"token comment\">// 로그 파일을 다시 열기</span></code></pre></div>\n<ul>\n<li>구성 테스트</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">sudo nginx <span class=\"token operator\">-</span>t\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">nginx</span><span class=\"token expression\"><span class=\"token operator\">:</span> the configuration file <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span>conf syntax is ok</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">nginx</span><span class=\"token expression\"><span class=\"token operator\">:</span> configuration file <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>nginx<span class=\"token punctuation\">.</span>conf test is successful</span></span></code></pre></div>\n<ul>\n<li>Ngnix index.html 위치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// NGINX</span>\ncd <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>share<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>html</code></pre></div>","fields":{"slug":"/posts/2023-21-08---Node-Ngnix-설정하기//posts/Node-Ngnix-설정하기","tagSlugs":["/tag/ssh/","/tag//"]},"frontmatter":{"date":"2023-08-21T22:40:32.169Z","description":"프로젝트의 Ngnix 경로를 바꾸거나 설정을 바꿔달라는 요청을 받았다. 급한 요청이기에 일단 메뉴얼대로 후다닥 처리한 후, Node와 Ngnix 개념에 대해 학습하고 설치해보며 알아갔다.","tags":["SSH","암호화"],"title":"Node, Ngnix 설정하기","socialImage":{"publicURL":"/static/01cb36d9228743e801c2d44463088b96/image1.png"}}}},"pageContext":{"slug":"/posts/2023-21-08---Node-Ngnix-설정하기//posts/Node-Ngnix-설정하기"}},"staticQueryHashes":["250566491","251939775","401334301"]}